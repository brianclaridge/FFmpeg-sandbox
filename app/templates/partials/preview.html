{% if success %}
<div class="preview-success">
    <p>Processing complete!</p>
    {% if is_video %}
    <video controls autoplay loop class="output-video">
        <source src="/preview/{{ output_file }}" type="video/mp4">
        Your browser does not support the video element.
    </video>
    {% else %}
    <audio controls autoplay>
        <source src="/preview/{{ output_file }}" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    {% endif %}
    <div class="preview-actions">
        <a href="/preview/{{ output_file }}" download="{{ output_file }}" class="btn-secondary">
            <i class="fas fa-download"></i> Download {{ output_format or ("Video" if is_video else "Audio") }}
        </a>
    </div>
</div>
<script>
    // Refresh history after successful processing
    htmx.ajax('GET', '/history', {target: '#history-area', swap: 'innerHTML'});
</script>
{% else %}
<div class="preview-error">
    <p>Processing failed</p>
    <pre>{{ error }}</pre>
</div>
{% endif %}
